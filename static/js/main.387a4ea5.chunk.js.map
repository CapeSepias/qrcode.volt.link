{"version":3,"sources":["pages/Generator.module.css","pages/App.module.css","locales lazy /^/.//.*/.ftl$/ groupOptions: {} namespace object","fluent/Localized.js","components/MultiButton.js","pages/Generator.js","pages/App.js","fluent/l10n.js","index.js"],"names":["module","exports","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","Localized","props","elems","br","Fragment","children","MultiButton","ariaLabel","items","defaultValue","onChange","style","className","useState","choosen","setChoosen","useEffect","handleClick","useCallback","event","newValue","target","dataset","value","display","item","title","icon","onClick","pointerEvents","verticalAlign","trigger_download","name","data","a","document","createElement","body","appendChild","download","href","click","remove","withLocalization","Inner","getString","errorCorrectionLevel","setErrorCorrectionLevel","filetype","setFiletype","qrcode","setQrcode","console","log","handleContentChange","QRCode","toString","type","scale","margin","color","light","dark","err","url","error","handleDownload","btoa","classes","qrcodeWrapper","qrcodeContentInput","placeholder","svgWrapper","dangerouslySetInnerHTML","__html","src","alt","downloadButton","l10n","React","useContext","FluentContext","fluentByObject","object","fallback","globalSupportedLocales","supportedLocales","thisSupportedLocales","filter","locale","includes","currentLocales","negotiateLanguages","userLocales","defaultLocale","args","App","app","rel","locales","de","en","_supportedLocales_","_defaultLocale_","fetchMessages","path","fetch","default","response","text","messages","FluentResource","createMessagesGenerator","all","fetched","reduce","obj","cur","assign","generateBundles","bundle","FluentBundle","addResource","f","AppLocalizationProvider","onLocaleChange","ReactLocalization","getDefaultBundles","bundles","setBundles","new_bundles","loadBundles","AppLanguageWrapper","navigator","languages","setUserLocales","currentLocale","setCurrentLocale","window","umami","systemLocales","Array","isArray","language","toLowerCase","split","trackEvent","handleLanguageChange","handleCurrentLocalesChange","length","onLanguageChange","domains","frontend","backend","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.387a4ea5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"qrcodeWrapper\":\"Generator_qrcodeWrapper__1MUQn\",\"qrcodeContentInput\":\"Generator_qrcodeContentInput__1C_pN\",\"downloadButton\":\"Generator_downloadButton__FFIYG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__3hbGO\"};","var map = {\n\t\"./de.ftl\": [\n\t\t86,\n\t\t3\n\t],\n\t\"./en.ftl\": [\n\t\t87,\n\t\t4\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 82;\nmodule.exports = webpackAsyncContext;","import React from 'react'\nimport {\n  Localized as LocalizedOriginal,\n  // withLocalization,\n} from '@fluent/react'\nimport { negotiateLanguages } from '@fluent/langneg'\n\nimport { FluentContext } from '../../node_modules/@fluent/react/esm/context.js'\n\nconst Localized = props => (\n  <LocalizedOriginal\n    key={props.id}\n    {...props}\n    elems={{\n      br: <br />,\n      ...props.elems,\n    }}\n  >\n    <React.Fragment>{props.children}</React.Fragment>\n  </LocalizedOriginal>\n)\n\n// A custom withLocalization to have an empty fallback.\n// It is nearly identical to the original.\nfunction withLocalization(Inner) {\n  function WithLocalization(props) {\n    const l10n = React.useContext(FluentContext)\n\n    const getString = (id, args, fallback) => l10n.getString(id, args, fallback || ' ')\n\n    const fluentByObject = (object, fallback) => {\n      if (!(!!fallback)) {\n        fallback = null\n      }\n\n      if (!!object) {\n        const globalSupportedLocales = l10n.supportedLocales || []\n        const thisSupportedLocales = Object.keys(object).filter(locale => globalSupportedLocales.includes(locale))\n\n        const currentLocales = negotiateLanguages(\n          l10n.userLocales,\n          thisSupportedLocales,\n          { defaultLocale: l10n.defaultLocale }\n        )\n\n        for (const locale of currentLocales) {\n          if (!!object[locale]) {\n            return object[locale]\n          }\n        }\n\n        return fallback\n      }\n\n      return fallback\n    }\n\n    return React.createElement(Inner, { fluentByObject, getString, ...props })\n  }\n  return WithLocalization\n}\n\nexport {\n  withLocalization,\n  Localized,\n  Localized as default,\n}\n\n/*\n\nimport { Localized, withLocalization } from '../Localized/'\n\n<Localized id=\"translation_id\" />\nexport default withLocalization(componentName)\n\n\nimport Localized from '../Localized/'\n<Localized id=\"translation_id\" />\n\nimport { withLocalization } from '@fluent/react'\nexport default withLocalization(componentName)\n\n*/\n","import { useState, useCallback, useEffect } from 'react'\n\nfunction MultiButton({ ariaLabel, items, defaultValue, onChange, style, className }) {\n  const [choosen, setChoosen] = useState()\n\n  useEffect(() => setChoosen(defaultValue), [defaultValue, setChoosen])\n\n  const handleClick = useCallback(event => {\n    const newValue = event.target.dataset.value\n    setChoosen(newValue)\n    if (onChange) {\n      onChange(newValue)\n    }\n  }, [setChoosen, onChange])\n\n  return <div\n    aria-label={ariaLabel}\n    className={'buttonRow ' + (className || '')}\n    style={{\n      display: 'inline-block',\n      ...style\n    }}\n  >\n    {\n      items.map(item => {\n        const value = item.value\n        const title = item.title\n        const icon = item.icon || null\n        return <button\n          key={value}\n          className={`${choosen === value ? 'choosen' : ''} ${!!icon ? 'hasIcon' : ''}`}\n          onClick={handleClick}\n          data-value={value}\n        >\n          <span style={{pointerEvents: 'none'}}>\n            {!!icon ? icon : null}\n            <span style={{verticalAlign: 'middle'}}>{title}</span>\n          </span>\n        </button>\n      })\n    }\n  </div>\n}\n\nexport default MultiButton\n","import React, { useState, useCallback } from 'react'\nimport classes from './Generator.module.css'\n\nimport { withLocalization, Localized } from '../fluent/Localized.js'\nimport MultiButton from '../components/MultiButton.js'\n\nimport QRCode from 'qrcode'\n\nfunction trigger_download(name, data) {\n  const a = document.createElement('a')\n  document.body.appendChild(a)\n  // a.target = '_blank'\n  a.download = name\n  a.href = data\n  a.click()\n  a.remove()\n}\n\nfunction Generator({ getString }) {\n  const [errorCorrectionLevel, setErrorCorrectionLevel] = useState('m')\n  const [filetype, setFiletype] = useState('svg')\n  const [qrcode, setQrcode] = useState(null)\n\n  console.log('errorCorrectionLevel', errorCorrectionLevel)\n  console.log('filetype', filetype)\n\n  const handleContentChange = useCallback(event => {\n    const value = event.target.value\n\n    // // With promises\n    // QRCode.toDataURL(value)\n    //   .then(url => {\n    //     console.log(url)\n    //   })\n    //   .catch(err => {\n    //     console.error(err)\n    //   })\n\n    if (filetype === 'svg') {\n      QRCode.toString(value, {\n        errorCorrectionLevel: errorCorrectionLevel,\n        type: 'svg',\n        scale: 1,\n        margin: 1,\n        color: {\n          light: '#ffffff',\n          dark: '#502379',\n        }\n      }, function (err, url) {\n        if (err) {\n          console.error(err)\n          setQrcode(null)\n        } else {\n          setQrcode(url)\n        }\n      })\n    } else {\n      setQrcode(null)\n    }\n  }, [filetype, setQrcode, errorCorrectionLevel])\n\n  const handleDownload = useCallback(() => {\n    if (filetype === 'svg') {\n      const b64 = 'data:image/svg+xml;base64,' + btoa(qrcode)\n      trigger_download('volt-qrcode.svg', b64)\n    } else {\n      const b64 = 'data:image/png;base64,'\n      trigger_download('volt-qrcode.png', b64)\n    }\n    // window.umami.trackEvent('F: ' + filetype)\n  }, [\n    filetype,\n    qrcode\n  ])\n\n  return <div className={classes.qrcodeWrapper}>\n    <h1><Localized id=\"website_title\" /></h1>\n\n    <textarea\n      className={classes.qrcodeContentInput}\n      placeholder={getString('text_content_input_placeholder')}\n      onChange={handleContentChange}\n    ></textarea>\n\n    <h2>\n      <Localized id=\"filetype_headline\" />\n    </h2>\n    <MultiButton\n      onChange={setFiletype}\n      ariaLabel={getString('filetype_headline')}\n      defaultValue={filetype}\n      items={[\n        {\n          value: 'svg',\n          title: 'SVG'\n        },\n        {\n          value: 'png',\n          title: 'PNG'\n        },\n      ]}\n    />\n    <br />\n    <br />\n\n    <h2>\n      <Localized id=\"error_correction_level_headline\" />\n    </h2>\n    <MultiButton\n      onChange={setErrorCorrectionLevel}\n      ariaLabel={getString('error_correction_level_headline')}\n      defaultValue={errorCorrectionLevel}\n      items={[\n        {\n          value: 'L', // low',\n          title: 'Low ~7%'\n        },\n        {\n          value: 'M', // edium',\n          title: 'Medium ~15%'\n        },\n        {\n          value: 'Q', // uartile',\n          title: 'Quartile ~25%'\n        },\n        {\n          value: 'H', // igh',\n          title: 'High ~30%'\n        },\n      ]}\n    />\n    <br />\n    <br />\n\n    {\n      qrcode === null\n        ? null\n        : <>\n          {\n            filetype === 'svg'\n              ? <span className={classes.svgWrapper} dangerouslySetInnerHTML={{__html: qrcode}}></span>\n              : <img src={qrcode} alt=\"\"/>\n          }\n          <button onClick={handleDownload} className={'green ' + classes.downloadButton}>Download</button>\n          </>\n    }\n  </div>\n}\n\nexport default withLocalization(Generator)\n","import classes from './App.module.css'\n\nimport Localized from '../fluent/Localized.js'\nimport Generator from './Generator.js'\n\nfunction App() {\n  return (<>\n    <div className={classes.app}>\n      <Generator />\n    </div>\n    <footer>\n      <a href=\"mailto:thomas.rosen@volteuropa.org\"><Localized id=\"contact\" /></a>\n      &nbsp; • &nbsp;\n      <a href=\"https://github.com/voltbonn/qrcode.volt.link\" target=\"_blank\" rel=\"noreferrer\"><Localized id=\"source_code\" /></a>\n    </footer>\n  </>)\n}\n\nexport default App\n","import React, { useEffect, useState } from 'react'\n\n// https://projectfluent.org/play/\n\n// import { LocalizationProvider, Localized } from '@fluent/react' // '@fluent/react/compat'\nimport { ReactLocalization, LocalizationProvider } from '@fluent/react'\nimport { FluentBundle, FluentResource } from '@fluent/bundle'\nimport { negotiateLanguages } from '@fluent/langneg'\n\n\nexport const locales = {\n  de: 'Deutsch',\n  en: 'English',\n  // es: 'Español',\n  // pt: 'Português',\n  // fr: 'Français',\n  // it: 'Italiano',\n  // nl: 'Dutch',\n  // pl: 'Polska',\n  // ru: 'Pусский',\n}\n\nconst _supportedLocales_ = Object.keys(locales)\nconst _defaultLocale_ = 'en'\n\n\nasync function fetchMessages(locale) {\n  const path = await import('../locales/' + locale + '.ftl')\n\n  const response = await fetch(path.default)\n  const messages = await response.text()\n\n  return { [locale]: new FluentResource(messages) }\n}\n\nfunction getDefaultBundles() {\n  const bundle = new FluentBundle('')\n  bundle.addResource(new FluentResource(''))\n  return new ReactLocalization([bundle])\n}\n\nasync function createMessagesGenerator(currentLocales) {\n  const fetched = await Promise.all(\n    currentLocales.map(fetchMessages)\n  )\n  const messages = fetched.reduce(\n    (obj, cur) => Object.assign(obj, cur)\n  )\n\n  return function* generateBundles() {\n    for (const locale of currentLocales) {\n      const bundle = new FluentBundle(locale)\n      bundle.addResource(messages[locale])\n      yield bundle\n    }\n  }\n}\n\nexport function AppLocalizationProvider({ userLocales, children, onLocaleChange }) {\n  const [bundles, setBundles] = useState(getDefaultBundles())\n\n  useEffect(() => {\n    async function loadBundles() {\n      const currentLocales = negotiateLanguages(\n        userLocales,\n        _supportedLocales_,\n        { defaultLocale: _defaultLocale_ }\n      )\n\n      if (!!onLocaleChange) {\n        onLocaleChange(currentLocales)\n      }\n\n      const generateBundles = await createMessagesGenerator(currentLocales)\n\n      const new_bundles = new ReactLocalization(generateBundles())\n      new_bundles.userLocales = userLocales\n      new_bundles.defaultLocale = _defaultLocale_\n      new_bundles.supportedLocales = _supportedLocales_\n      setBundles(new_bundles)\n    }\n    loadBundles()\n  }, [userLocales, onLocaleChange])\n\n  if (!bundles) {\n    // Show a loader.\n    return <div>Loading texts…</div>\n  }\n\n  return <LocalizationProvider l10n={bundles}>\n    {children}\n  </LocalizationProvider>\n}\n\n","import React, { useState, useEffect, useCallback } from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './pages/App.js'\n// import reportWebVitals from './reportWebVitals'\nimport { BrowserRouter as Router } from 'react-router-dom'\n\nimport 'intl-pluralrules'\nimport { AppLocalizationProvider, locales } from './fluent/l10n.js'\n\nwindow.domains = {\n  // frontend: 'https://qrcode.volt.link',\n  frontend: 'http://localhost:3000/',\n  // backend: 'https://volt.link/',\n  backend: 'http://localhost:4000/',\n}\n\nfunction AppLanguageWrapper() {\n  // const [userLocales, setUserLocales] = useState(['de'])\n  const [userLocales, setUserLocales] = useState(navigator.languages)\n  const [currentLocale, setCurrentLocale] = useState(null)\n\n  useEffect(() => {\n    if (!!window.umami) {\n      let systemLocales = navigator.languages\n      if (!!systemLocales || Array.isArray(systemLocales)) {\n        for (let locale of systemLocales) {\n          locale = locale.toLowerCase() // Not really correct but the system locales sadly don't conform to the standard.\n\n          const language = locale.split('-')[0]\n          if (language !== locale) {\n            window.umami.trackEvent('L: ' + language) // Log just the language.\n          }\n          window.umami.trackEvent('L: ' + locale) // Log the full locale.\n        }\n      }\n    }\n  }, [])\n\n  const handleLanguageChange = useCallback(event => {\n    setUserLocales([event.target.dataset.locale])\n  }, [setUserLocales])\n\n  const handleCurrentLocalesChange = useCallback(currentLocales => {\n    setCurrentLocale(currentLocales.length > 0 ? currentLocales[0] : '')\n  }, [setCurrentLocale])\n\n  return <AppLocalizationProvider\n    key=\"AppLocalizationProvider\"\n    userLocales={userLocales}\n    onLocaleChange={handleCurrentLocalesChange}\n  >\n    <App locales={locales} currentLocale={currentLocale} onLanguageChange={handleLanguageChange} />\n  </AppLocalizationProvider>\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <AppLanguageWrapper />\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals()\n"],"sourceRoot":""}